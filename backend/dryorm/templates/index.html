{% extends 'base.html' %}
{% block title %}Dry ORM{% endblock %}

{% block right-actions %}
<div class="hidden md:flex items-center gap-2">
    <label class="flex items-center space-x-1">
        <span class="text-md text-gray-400 whitespace-nowrap">Private ?</span>
        <input type="checkbox" id="isPrivate"
                               class="w-4 h-4 rounded-sm accent-gray-800 border-2 border-yellow-500 text-yellow-500 focus:ring-yellow-500 focus:ring-2">
    </label>
    <input type="text" id="name" placeholder="Name" class="bg-gray-800 text-white px-2 py-2 rounded-sm border border-gray-600 focus:outline-none focus:border-yellow-500">
    <button class="bg-slate-500 hover:bg-slate-600 text-white px-4 py-2 rounded-sm" id="save">Save</button>
</div>
<button class="bg-yellow-600 hover:bg-yellow-700 disabled:opacity-40 text-white px-4 py-2 rounded-sm disabled" id="run">Execute</button>
{% endblock %}

{% block center-actions %}
{% endblock %}

{% block content %}
<div id="main_grid" class="flex-1 grid lg:grid-cols-2 md:grid-cols-1 gap-0.5">
    <div class="bg-white flex flex-col h-full">
        <div class="flex items-center justify-between p-4 border-b">
            <div class="flex items-center space-x-4">
                <h5 class="font-bold">Code</h5>
                <span id="job" class="text-gray-600 px-3 rounded opacity-50 whitespace-nowrap"></span>
            </div>
            <select id="template-select" class="px-2 rounded-sm border border-gray-800 focus:outline-none">
                <option value="">Select a template</option>
                {% for key, _ in templates.items %}
                    <option value="{{key}}">{{key}}</option>
                {% endfor %}
            </select>
        </div>
        <textarea id="code_models">{{ object.code }}</textarea>
    </div>
    <div id="right_column" class="bg-white flex flex-col h-full collapsed">
        <div class="p-4 border-b">
            <h5 class="font-bold">Output:</h5>
        </div>
        <div class="p-3 overflow-auto bg-yellow-50">
            <pre id="output" class="whitespace-pre-wrap h-full">No output.</pre>
        </div>
        <div class="p-4 border-b border-t">
            <h5 class="font-bold">Queries:</h5>
        </div>
        <div class="flex flex-col" id="queries">
            <pre class="whitespace-pre-wrap h-full p-2">No queries.</pre>
        </div>
    </div>
</div>

<template id="query_template">
    <pre class="text-md max-w-full"><code class="language-sql whitespace-pre-wrap break-all"></code></pre>
</template>

{% csrf_token %}

{{ templates|json_script:'templates' }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.30.0/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.30.0/mode/python/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.30.0/mode/sql/sql.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
{% endblock %}
