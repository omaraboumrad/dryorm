<main id="main-section" class="flex-grow px-4 py-3">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {% for object in object_list %}
            <div class="border border-gray-200 rounded-lg bg-white shadow-sm" x-data="{ expanded: false }">
                <div class="flex items-center p-3 hover:bg-django-secondary/10 transition cursor-pointer" @click="expanded = !expanded">
                    <div class="flex flex-col flex-grow truncate">
                        <div class="flex items-center gap-2">
                            <a href="{% url 'detail' object.slug %}" class="text-md font-semibold text-django-primary truncate hover:underline" @click.stop>{{ object.name }}</a>
                        </div>
                        <div class="text-sm text-gray-400 mt-1">{{ object.database }} â€¢ {{ object.created|timesince }}</div>
                    </div>
                    <div class="ml-2 p-1">
                        <svg class="w-4 h-4 transform transition-transform" :class="{ 'rotate-90': expanded }" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                </div>
                <div class="px-4 py-3 border-t text-xs bg-gray-50" x-show="expanded">
                    {% with parsed=object.parse_code %}
                    <div class="flex flex-wrap gap-1">
                        {% for import in parsed.imports %}
                            <span class="px-1.5 py-0.5 bg-django-secondary/20 text-django-text rounded-full">{{ import }}</span>
                        {% endfor %}
                        {% for class in parsed.classes %}
                            <span class="px-1.5 py-0.5 bg-django-primary/20 text-django-primary rounded-full">{{ class }}</span>
                        {% endfor %}
                        {% if not parsed.imports and not parsed.classes %}
                            <span class="text-gray-500">No imports or classes found</span>
                        {% endif %}
                    </div>
                    {% endwith %}
                </div>
            </div>
        {% empty %}
            <div class="col-span-2 py-8 text-center text-gray-500">No snippets found. ðŸ˜”</div>
        {% endfor %}
    </div>
    {% if is_paginated %}
        <nav class="mt-4 flex justify-center space-x-2 text-sm text-django-primary">
            {% if page_obj.has_previous %}
                <a href="?page=1" class="px-2 py-1 border border-gray-300 rounded">First</a>
                <a href="?page={{ page_obj.previous_page_number }}"
                   class="px-2 py-1 border border-gray-300 rounded">Prev</a>
            {% endif %}
            <span class="px-3 py-1">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}"
                   class="px-2 py-1 border border-gray-300 rounded">Next</a>
                <a href="?page={{ page_obj.paginator.num_pages }}"
                   class="px-2 py-1 border border-gray-300 rounded">Last</a>
            {% endif %}
        </nav>
    {% endif %}
</main>
